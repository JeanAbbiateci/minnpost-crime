/*! minnpost-crime - v0.0.1 - 2013-06-14
* https://github.com/MinnPost/minnpost-crime
* Copyright (c) 2013 ; Licensed MIT */

var mpApp=mpApp||{};mpApp["minnpost-crime"]=mpApp["minnpost-crime"]||{},_.mixin({formatCurrency:function(t){var e=/(\d+)(\d{3})/;for(split=(""+t.toFixed(2)).split(".");e.test(split[0]);)split[0]=split[0].replace(e,"$1,$2");return"$"+split[0]+"."+split[1]},formatPercentage:function(t){return""+(100*t).toFixed(1)+"%"}}),_.isFunction(Backbone.$.jsonp)&&(Backbone.ajax=function(){return Backbone.$.jsonp.apply(Backbone.$,arguments)}),function(t,e){t.defaultOptions={dataPath:"./"},t.templates=t.templates||{},t.getTemplate=function(n,o,i){var a="js/templates/"+n+".html";i=i||t,_.isUndefined(t.templates[a])?e.ajax({url:a,method:"GET",async:!1,contentType:"text",success:function(e){t.templates[a]=_.template(e),o.apply(i,[t.templates[a]])}}):o.apply(i,[t.templates[a]])},t.data=t.data||{},t.getData=function(n){var o="http://mp-jsonproxy.herokuapp.com/proxy?callback=?&url=",i=!1,a=[];return n=_.isArray(n)?n:[n],t.options&&0===t.options.dataPath.indexOf("http")&&(i=!0),_.each(n,function(n){var p;p=i?e.jsonp({url:o+encodeURI(t.options.dataPath+n+".json")}):e.getJSON(t.options.dataPath+n+".json"),a.push(p)}),e.when.apply(e,a)}}(mpApp["minnpost-crime"],jQuery),function(t){t.Application=Backbone.Router.extend({routes:{"city/:city":"routeCity","neighborhood/:city/:neighborhood":"routeNeighborhood","*defaultR":"routeDefault"},initialize:function(e){t.options=_.extend(t.defaultOptions,e),_.bindAll(this),this.start()},start:function(){Backbone.history.start()},routeDefault:function(){this.navigate("/city/minneapolis",{trigger:!0,replace:!0})},routeCity:function(){},neighborhood:function(){}}),t.start=function(e){return t.router=new t.Application(e),t}}(mpApp["minnpost-crime"],jQuery);